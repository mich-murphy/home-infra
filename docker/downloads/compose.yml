---
services:
  deluge:

    image: ghcr.io/linuxserver/deluge:2.2.0-r1-ls361@sha256:8e0d495f10f2ee29919f229ae0b32d92f2b7a5d5339fc6f171f19f3f94b9ed56
    container_name: deluge
    security_opt:
      - no-new-privileges:true
    networks:
      - proxy
    environment:
      - PUID=1215
      - PGID=1215
      - TZ=${TZ}
      - DELUGE_LOGLEVEL=error #optional
    volumes:
      - deluge-data:/config
      - /mnt/data/torrents:/data/torrents:rw
    ports:
      - 25565:25565
      - 25565:25565/udp
    labels:
      - traefik.enable=true
      - traefik.http.routers.deluge.rule=Host(`deluge.local.elmurphy.com`)
      - traefik.http.routers.deluge.tls=true
      - traefik.http.services.deluge.loadbalancer.server.port=8112
    restart: unless-stopped

  # NOTE: initial setup is done via "http://<docker localhost ip>:8080"
  # hostname must be added to host_whitelist in sabnzbd.ini
  # reference: https://sabnzbd.org/wiki/extra/hostname-check.html
  sabnzbd:
    image: ghcr.io/linuxserver/sabnzbd:4.5.5-ls240@sha256:a46e75d861e6b26d7ee263b22743d6fdaaa4a5ccd42168b6ea563a2f047d9438
    container_name: sabnzbd
    security_opt:
      - no-new-privileges:true
    networks:
      - proxy
    environment:
      - PUID=1215
      - PGID=1215
      - TZ=${TZ}
    volumes:
      - sabnzbd-data:/config
      - /mnt/data/usenet:/data/usenet:rw
    labels:
      - traefik.enable=true
      - traefik.http.routers.sabnzbd.rule=Host(`sabnzbd.local.elmurphy.com`)
      - traefik.http.routers.sabnzbd.tls=true
      - traefik.http.services.sabnzbd.loadbalancer.server.port=8080
    restart: unless-stopped

volumes:
  deluge-data:
    name: deluge-data
  sabnzbd-data:
    name: sabnzbd-data

networks:
  proxy:
    external: true
